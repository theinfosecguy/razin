rule_id: SECRET_REF
version: 1
metadata:
  title: "Environment secret reference"
  description: "Configuration includes environment secret references."
  recommendation: "Ensure referenced secrets are minimally scoped and never logged."
  confidence: medium
scoring:
  base_score: 60
match:
  source: fields
  strategy: field_pattern_match
  pattern: "(\\$\\{[A-Z0-9_]+\\}|\\$[A-Z_][A-Z0-9_]*|\\{\\{\\s*secrets\\.[^}]+\\}\\}|os\\.getenv\\()"
  exclude_pattern_fn: is_non_secret_env_ref
dedupe: true
